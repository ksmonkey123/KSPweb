\documentclass[a4paper, 11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[absolute]{textpos}
\usepackage[english]{babel}
\usepackage[left=2cm, right=2cm, top=2cm, bottom=2.5cm]{geometry}
\usepackage{hyperref}
\usepackage{float}
%\usepackage{euler}
\usepackage{caption}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}

\title{Optimal Inclination Change Manoeuvres for Circular Orbits}
\author{Andreas WÃ¤lchli}
\date{\today}

\begin{document}
\maketitle

\section{Motivation}
Inclination changes are very expensive. It is intuitively clear that for small inclination angles a direct manoeuvre (i.e. a manoeuvre that directly transitions from the original orbit into the target orbit) is the most efficient solution, however it is also clear that for very large angles this solution gets increasingly more expensive. At some point we expect a bi-elliptical transfer to be more efficient. In this manoeuvre there are 3 distinct engine burns. The first one raises the apoapsis to create a highly elliptical orbit. The second one performs the inclination change at the new apoapsis. And the third and last one lowers the apoapsis at the periapsis to reach the target orbit. Assuming that for small angles a direct manoeuvre is optimal and for large angles a bi-elliptic transfer is optimal we need to especially consider the transitional range where the optimal apoapsis height for the bi-elliptic transfer depends on the angle of the inclination change.

\section{Basic Formulae}
The orbital velocity formulae depend on the \emph{standard gravitational parameter} $\mu$ of the central body. We treat this as a constant as we only consider orbits with a single parent body and and infinite \emph{sphere of influence}.

For an elliptical orbit with periapsis\footnote{all altitudes are measured from the center of the parent body} $r_p$ and an apopasis $r_a$ (note that $r_p \leq r_a$) the orbital velocity $v(r)$ for a given altitude $r \in [r_p,r_a]$ can be determined as
$$v_{(r_p,r_a)}(r) = \sqrt{\mu\left(\frac{2}{r}-\frac{2}{r_p + r_a}\right)}$$

For a circular orbit ($r_p = r_a = r$) this simplifies to
$$v_c(r) = v_{(r,r)}(r) = \sqrt{\frac{\mu}{r}}$$

We can now determine the change in velocity ($\Delta{}v$) required to transition from a circular orbit with altitude $r$ into a elliptical orbit with periapsis $r_p = r$ and an arbitrary apopapsis $r_a > r_p$
$$\Delta{}v_1 = v_{(r,r_a)}(r) - v_c(r) = \sqrt{\mu\left(\frac{2}{r}-\frac{2}{r + r_a}\right)} - \sqrt{\frac{\mu}{r}}$$

To simplify the following equations involving elliptical orbits we will no longer state the apoapsis $r_a$ explicitly, but rather a scaling factor $f \in [1, \infty)$ such that $r_a = fr_p$. For circular orbits $f=1$. Therefore the above equation for $\Delta{}v_1$ simplifies to
$$\Delta{}v_1
= \sqrt{\mu\left(\frac{2}{r}-\frac{2}{r(f+1)}\right)} - \sqrt{\frac{\mu}{r}}
= \sqrt{\frac{\mu}r}\left(   \sqrt{\frac{2f}{f+1}} - 1  \right)
$$

For the inclination change manoeuvre we must consider the problem geometrically: An inclination change by an angle $\theta \in [0,\pi]$ simply rotates the velocity vector by that angle $\theta$. Assuming $\vec{a}$ to be the initial velocity vector and $\vec{b}$ with $|\vec{b}| = |\vec{a}|$, where the angle between $\vec{a}$ and $\vec{b}$ is $\theta$, the target velocity vector, the change in velocity required is $\Delta{}v_2 = |\vec{b} - \vec{a}|$. The vectors $\vec{a}$ and $\vec{b}$ form the legs of an isosceles triangle with the vertex angle $\theta$.
The length $|\vec{a}|$ of the vector $\vec{a}$ corresponds to the orbital velocity at the point of the manoeuvre. Since we only consider inclination changes at the apoapsis, $|\vec{a}| = v_{(r,fr)}(fr)$. $\Delta{}v_2$ forms the base of this triangle and can be calculated as
$$\Delta{}v_2
= 2|\vec{a}|\sin\frac{\alpha}2
= 2\sqrt{  \mu \left(  \frac{2}{fr} - \frac{2}{fr + r}  \right) } \sin\frac{\alpha}2
= \sqrt{\frac{4\mu}r} \sqrt{\frac{2}{f^2+f}} \sin\frac{\alpha}2
$$

We can now compose all of this to formulate the total energy requirements for a bi-elliptic transfer
$$\Delta{}v_{tot}
= 2\Delta{}v_1 + \Delta{}v_2
= \sqrt{\frac{4\mu}r}\left( \sqrt{\frac{2f}{f+1}} - 1  \right) + \sqrt{\frac{4\mu}r} \sqrt{\frac{2}{f^2+f}} \sin\frac{\alpha}2$$

With some simplifications we get
$$\Delta{}v_{tot}= \sqrt{\frac{4\mu}r}\left[ \sqrt{\frac{2}{f^2 + f}} \left(f + \sin\frac{\theta}2 \right) - 1  \right]$$

\section{Finding the Optimal Transfer}
Finding the optimal transfer manoeuvre can be done by minimising $\Delta{}v_{tot}$ for a given $\theta$. If we are able to determine the derivative of $\Delta v_{tot}$ we can determine the optimal scaling factor $f$ by finding the roots of that derivative.

$$\frac{\partial}{\partial f}\Delta v_{tot}
= \sqrt\frac{8\mu}{r} \frac{\partial}{\partial f}\left[ \sqrt{\frac{1}{f^2+f}} \left( f + \sin\frac{\theta}{2} \right)\right]
= \sqrt\frac{8\mu}{r} \left[ \sqrt{\frac{1}{f^2+f}} \left(1- \frac{2f^2+f+2f\sin\frac\theta 2 + \sin\frac\theta 2}{2f^2+2f} \right)\right]
$$

It is clearly visible that for a fixed $\theta$ there exist two roots at
$$\sqrt{\frac{1}{f^2+f}} = 0 \quad\text{and}\quad  \frac{2f^2+f+2f\sin\frac\theta 2 + \sin\frac\theta 2}{2f^2+2f} =1$$
$$f = \infty \quad \text{and} \quad f = \frac{\sin\frac\theta 2}{1-2\sin\frac\theta 2}$$

The first root is trivial and describes the fact that
$$\lim_{f\to\infty}\Delta v_{tot} = \sqrt{\frac{8\mu}{r}}$$

The second root is a bit more difficult to understand. Intuitively it represents the optimal value $f$ for a given $\theta$.
Given that $f$ is limited to the range $[1,\infty)$ not all values for $\theta$ are usable.
The angle $\theta$ for $f=1$ is
$$\frac{\sin\frac\theta 2}{1-2\sin\frac\theta 2} = 1 \Rightarrow \sin\frac\theta 2 = \frac13 \Rightarrow \theta = 2\sin^{-1}\frac13 \approx 39^\circ$$

This lies well within the range $[0,\pi]$ and is therefore acceptable. The angle $\theta$ for $f=\infty$ is
$$\frac{\sin\frac\theta 2}{1-2\sin\frac\theta 2} \to \infty \Rightarrow \sin\frac\theta2 = \frac12 \Rightarrow \theta = \frac\pi3=60^\circ $$

This lies once again well within the range $[0,\pi]$. These two angles define the lower and the upper bound to the transitional range.

\section{Conclusion}
The optimal scaling factor $f$ for an angle $\theta$ can be determined as
$$
f(\theta) = \begin{cases}
1 & \text{if } \theta < 2\sin^{-1}\frac13\\
\frac{\sin\frac\theta 2}{1-2\sin\frac\theta 2} & \text{if } \theta \in [2\sin^{-1}\frac13,\frac\pi3]\\
\infty & \text{if } \theta > \frac\pi3
\end{cases}$$
This factor $f$ determines the apoapsis altitude relative to the circular orbit altitude $r$
$$r_a = fr$$
The energy requirements for that manoeuvre can be determined by
$$\Delta{}v_{tot}= \sqrt{\frac{4\mu}r}\left[ \sqrt{\frac{2}{f^2 + f}} \left(f + \sin\frac{\theta}2 \right) - 1  \right]$$
\hfill $\square$
\end{document}